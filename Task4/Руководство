Просто надо знать условие Фано, строить бинарные деревья и всё, будет тебе счастье.
Всё максимально просто.